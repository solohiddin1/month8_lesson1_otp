{% extends "base.html" %}
{% block title %}Forgot Password{% endblock %}
{% block header %}Forgot Password{% endblock %}

{% block content %}
<h2>Forgot Password</h2>
<form id="forgotForm">
    <label>Email:</label>
    <input type="email" id="email" required><br>
    <button type="submit">Send Reset Link</button>
</form>
<p id="message" style="color:red;"></p>

<script>
document.getElementById("forgotForm").addEventListener("submit", async function(e) {
    e.preventDefault();

    const email = document.getElementById("email").value;
    const messageEl = document.getElementById("message");
    messageEl.innerText = "";

    try {
        const response = await fetch("{% url 'forgot_password' %}", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ email: email })
        });

        const data = await response.json();

        if (response.ok && data.reset_link) {
            messageEl.style.color = "green";
            messageEl.innerText = "Check your email for reset link!";
        } else {
            messageEl.style.color = "red";
            messageEl.innerText = data.error || "Request failed!";
        }
    } catch (err) {
        messageEl.style.color = "red";
        messageEl.innerText = "Something went wrong!";
    }
});

</script>
{% endblock %}
